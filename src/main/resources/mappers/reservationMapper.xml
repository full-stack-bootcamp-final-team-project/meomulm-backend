<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.meomulm.reservation.model.mapper.ReservationMapper">

    <!-- 예약 조회 -->
    <!-- <select id="selectAllReservationsByUserId"> -->
    <!-- </select> -->

    <!-- 예약 조회 (예약Id) -->
    <!-- <select id="selectReservationById"> -->
    <!-- </select> -->

    <!-- 예약 추가 -->
    <insert id="insertReservation" parameterType="Reservation">
        INSERT INTO reservation (user_id, product_id, booker_name, booker_email, booker_phone, check_in_date, check_out_date, status, total_price, created_at)
        VALUES (#{userId}, #{productId}, #{bookerName}, #{bookerEmail}, #{booker_phone}, #{checkInDate}, #{checkOutDate}, 'NOT_PAID', #{totalPrice}, NOW())
    </insert>

    <!-- 예약 수정 -->
    <update id="updateReservation">
        UPDATE reservation
        SET booker_name = #{bookerName},
            booker_email = #{bookerEmail},
            booker_phone = #{bookerPhone}
        WHERE reservation_id = #{reservationId}
    </update>

    <!-- 예약 상태 변경 (결제 후) -->
    <update id="updateStatusToPaid">
        UPDATE reservation
        SET status = 'PAID'
        WHERE reservation_id = #{reservationId}
    </update>

    <!-- 예약 상태 변경 (이용 후) -->
    <update id="updateStatusToUsed">
        UPDATE reservation
        SET status = 'USED'
        WHERE reservation_id = #{reservationId}
    </update>

    <!-- 예약 취소 (상태 변경) -->
    <update id="deleteReservation">
        UPDATE reservation
        SET status = 'CANCELED'
        WHERE reservation_id = #{reservationId}
    </update>
</mapper>
